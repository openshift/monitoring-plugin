## 1. CRITICAL: Filtering Bugs

**Automation Status**: AUTOMATED in `01.reg_filtering.cy.ts` 

### Prerequisites: Test Data Setup for Filtering Tests

**CSV Format** - Use this with your simulation script (these create incidents A, B, D, H):

```csv
start,end,alertname,namespace,severity,silenced,labels
0,180,AlertA_Info,openshift-logging,info,false,{"component": "logging"}
240,360,AlertB_Warning,openshift-storage,warning,false,{"component": "storage"}
480,780,AlertD_Info,openshift-monitoring,info,false,{"component": "monitoring"}
540,780,AlertD_Warning,openshift-monitoring,warning,false,{"component": "monitoring"}
600,780,AlertD_Critical,openshift-monitoring,critical,false,{"component": "monitoring"}
1560,1740,AlertH_Critical,openshift-network,critical,false,{"component": "network"}
```

**Quick Reference**:
| Incident | Component | Severity History | State | Time Range |
|----------|-----------|------------------|-------|------------|
| A | logging | Info | Resolved | 0-180 |
| B | storage | Warning | Resolved | 240-360 |
| D | monitoring | Info→Warning→Critical | Firing | 480-780 |
| H | network | Critical | Firing | 1560-1740 |

### 1.1 Incident Severity Filtering (Not Alert Severity)
**BUG**: Incidents were being filtered by underlying alert severities instead of the incident's own severity history.

- [ ] **Filter by "Critical"**: 
  
- [ ] **Filter by "Warning"**: 
  
- [ ] **Filter by "Informative"**: 
  
- [ ] **Multiple Severity Filters (e.g., Critical + Warning)**:

For each, ensure that the correct incidents are shown. The particular numbers may be slightly off if additional alerts are firing in the cluster.

### 1.2 Resolved Incident Filter Not Working
**BUG**: "Resolved" state filter wasn't working correctly.

- [ ] **Filter by "Resolved"**: 
- [ ] **Filter by "Firing"**: 
- [ ] **Verify Resolution Logic**:
  - Firing: `currentTime - lastTimestamp <= 10 minutes`
  - Resolved: `currentTime - lastTimestamp > 10 minutes`
  - Check Incidents that are resolved have last activity > 10 min ago

### 1.3 Combined Filtering (AND Logic Between Categories)
- [ ] **Critical + Resolved**:   
- [ ] **Warning + Resolved**: 
- [ ] **Critical + Firing**: 


- [ ] **Filter Persistence on URL**: Apply filters, refresh page
  - Apply: Warning + Resolved
  - Check URL: `?days=7+days&severity=Warning&state=Resolved`
  - Refresh page → verify Incident B still shown